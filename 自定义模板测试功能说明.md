# 🧪 自定义模板测试功能说明

## 功能概述

新增的自定义模板测试功能允许用户上传自己的PPT模板，并使用项目的AI智能填充功能进行测试。这个功能完全独立于智能分页和Dify API功能，专门用于验证和测试自定义PPT模板的效果。

## ✨ 主要特色

### 🎨 保持原有设计
- 完全保留您的模板样式、颜色、字体和布局
- 只填充内容到指定的占位符位置
- 不改变模板的整体设计风格

### 🤖 智能内容分配
- AI自动理解文本结构和含义
- 根据占位符名称智能匹配相应内容
- 支持多种内容类型的处理

### 🔧 独立测试环境
- 与智能分页功能完全独立
- 与Dify API功能完全独立
- 专门用于模板测试和验证

## 📋 使用步骤

### 1. 启动应用
```bash
python run_user_app.py
```

### 2. 选择功能标签
在Web界面中选择 **"🧪 自定义模板测试"** 标签页

### 3. 准备PPT模板
确保您的PPT模板包含占位符，格式如：
- `{标题}` - 用于填充标题内容
- `{内容}` - 用于填充主要内容
- `{要点1}` - 用于填充要点信息
- `{描述}` - 用于填充描述性文字
- `{结论}` - 用于填充结论内容

### 4. 上传模板文件
- 点击文件上传区域
- 选择您的 `.pptx` 格式模板文件
- 系统会自动验证文件格式和分析模板结构

### 5. 输入测试内容
在文本区域输入您想要填充到模板中的内容

### 6. 选择处理选项
- 如果使用支持视觉功能的AI模型，可以选择启用视觉优化
- 如果使用基础模型，将进行标准的内容填充和美化

### 7. 开始测试
点击 **"🧪 测试自定义模板"** 按钮开始处理

### 8. 下载结果
处理完成后，下载填充后的PPT文件查看效果

## 📄 模板要求

### 文件格式
- **必须**: `.pptx` 格式
- **建议**: 文件大小 < 50MB
- **推荐**: 结构清晰的模板设计

### 占位符规范
- 使用大括号包围: `{占位符名称}`
- 名称要有意义: `{项目标题}` 比 `{text1}` 更好
- 避免特殊字符和空格
- 建议使用中文描述性名称

### 示例占位符
```
{项目标题}
{副标题}
{日期}
{章节标题}
{主要内容}
{要点1}
{要点2}
{要点3}
{详细描述}
{结论}
{总结}
```

## 🧪 测试模板

项目包含一个预制的测试模板 `test_custom_template.pptx`，包含以下占位符：

### 第1页 - 标题页
- `{项目标题}` - 主标题
- `{副标题}` - 副标题
- `{日期}` - 日期信息

### 第2页 - 内容页1
- `{章节标题1}` - 章节标题
- `{要点1}`, `{要点2}`, `{要点3}` - 要点列表
- `{详细内容1}` - 详细描述

### 第3页 - 内容页2
- `{章节标题2}` - 章节标题
- `{核心观点}` - 核心观点
- `{论据1}`, `{论据2}` - 支撑论据
- `{详细内容2}` - 详细描述

### 第4页 - 结论页
- `{结论标题}` - 结论标题
- `{总结内容}` - 总结内容
- `{收获1}`, `{收获2}`, `{收获3}` - 关键收获
- `{结语}` - 结语

## 🎯 使用建议

### 测试文本示例
```
人工智能技术发展报告

人工智能技术正在快速发展，深度学习和大语言模型展现出前所未有的能力。

技术原理方面，神经网络架构的创新推动了AI能力的突破。Transformer架构成为了现代AI系统的基础，支撑着从自然语言处理到计算机视觉的各种应用。

应用领域包括自动驾驶、医疗诊断、金融分析等多个方向。这些应用不仅提高了效率，还创造了全新的业务模式和价值。

核心观点是AI技术将继续快速发展，但需要关注安全性和伦理问题。

关键因素包括算力提升、数据质量改善和算法优化。这三个方面的协同发展推动了整个AI领域的进步。

未来发展趋势显示，AI将变得更加智能化、普及化和专业化。同时，人机协作将成为主流模式，而非完全的自动化替代。

总结来说，AI技术发展前景广阔，但需要平衡创新与责任，确保技术发展造福人类社会。
```

### 最佳实践
1. **模板设计**: 确保占位符名称清晰易懂
2. **内容准备**: 文本内容结构化，便于AI理解
3. **测试迭代**: 多次测试不同内容，优化模板设计
4. **结果检查**: 下载后在PowerPoint中检查填充效果

## ⚠️ 注意事项

1. **独立功能**: 此功能与智能分页、Dify API功能完全独立
2. **临时文件**: 上传的模板文件会被临时保存，处理完成后自动清理
3. **API消耗**: 每次测试都会调用AI API，请注意API使用量
4. **文件安全**: 上传的文件仅用于测试，不会被永久保存

## 🔧 技术实现

该功能基于以下技术栈：
- **前端**: Streamlit Web界面
- **PPT处理**: python-pptx库
- **AI分析**: OpenRouter/DeepSeek API
- **文件处理**: Python tempfile模块
- **格式验证**: 自定义PPT文件验证器

## 🆘 常见问题

### Q: 上传文件后提示"未检测到占位符"？
A: 请确保模板中包含 `{名称}` 格式的占位符，而不是其他形式的文本。

### Q: 处理过程中出现错误？
A: 检查API密钥是否有效，网络连接是否正常，模板文件是否损坏。

### Q: 生成的结果不理想？
A: 可以调整占位符的名称使其更具描述性，或者优化输入文本的结构。

### Q: 如何创建更好的模板？
A: 使用有意义的占位符名称，保持合理的页面布局，避免过于复杂的设计。

---

**💡 提示**: 这个功能是为了测试和验证自定义模板而设计的，建议先用测试模板熟悉流程，再使用您自己的正式模板。
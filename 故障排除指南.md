# 🔧 故障排除指南

## 🚨 常见错误及解决方案

### 1. 环境变量配置错误

**错误信息**：
```
❌ Dify API密钥未配置
❌ DASHSCOPE_API_KEY 未配置
```

**解决方案**：
1. 复制环境变量模板：
   ```bash
   cp .env.example .env
   ```

2. 编辑 `.env` 文件，配置API密钥：
   ```
   DIFY_API_KEY_1=your-dify-key-1
   DIFY_API_KEY_2=your-dify-key-2
   DIFY_API_KEY_3=your-dify-key-3
   DIFY_API_KEY_4=your-dify-key-4
   DIFY_API_KEY_5=your-dify-key-5
   DASHSCOPE_API_KEY=your-qwen-key
   ```

3. 重启应用生效

### 2. 模块导入错误

**常见错误**：
```
ModuleNotFoundError: No module named 'ai_page_splitter'
```

**解决方案**：
```bash
pip install -r requirements.txt
pip install python-dotenv
```

### 3. API密钥验证失败

**错误信息**：
```
❌ API密钥验证失败
```

**解决方案**：
1. 检查Dify API密钥格式和有效性
2. 检查阿里云DashScope API密钥
3. 确认账户余额充足

### 4. 模板库问题

**错误信息**：
```
❌ 模板库文件夹不存在
```

**解决方案**：
确保目录结构完整：
```
templates/
├── title_slides.pptx
├── ending_slides.pptx
└── ppt_template/
    ├── split_presentations_1.pptx
    ├── split_presentations_2.pptx
    └── ... (到250)
```

### 5. PPT合并失败

**常见原因**：
- 模板文件损坏
- 权限不足
- 依赖包版本不兼容

**解决方案**：
1. 检查模板文件完整性
2. 更新依赖包：
   ```bash
   pip install --upgrade python-pptx
   ```
3. 系统会按优先级尝试：Spire → Win32COM → 格式基准合并

## 🔍 调试步骤

### 1. 检查环境配置
```bash
# 验证.env文件存在
ls -la .env

# 启动应用检查错误信息
python start_user_app.py
```

### 2. 验证模块导入
```bash
python -c "import ai_page_splitter; print('✅ AI分页模块正常')"
python -c "import dify_template_bridge; print('✅ Dify桥接模块正常')"
```

### 3. 查看日志
```bash
tail -f app.log
```

## 📊 性能优化

### 提高处理速度
- 确保网络连接稳定
- 页面数量控制在25页内
- 使用多密钥负载均衡

### 提高成功率
- 配置完整的环境变量
- 确保模板库文件完整
- 使用Spire合并器优先级

## 🆘 常见问题检查清单
- [ ] 环境变量配置完整(.env文件)
- [ ] 依赖包已安装(requirements.txt)
- [ ] 模板库文件完整(250个模板)
- [ ] API密钥有效且有余额
- [ ] Python版本 >= 3.8

## 💡 快速解决
大多数问题源于环境变量未配置，请优先检查 `.env` 文件配置。 